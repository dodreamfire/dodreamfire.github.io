<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>두드림소방 | 일정관리</title>
  <meta name="description" content="두드림소방의 전문 일정관리 페이지입니다. 안전한 소방시설 시공과 관리를 위한 체계적인 일정관리를 지원합니다." />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet" />
  <style>
    /* Reset & 기본 스타일 */
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0; padding: 0;
      font-family: 'Noto Sans KR', sans-serif;
      background-color: #fefefe;
      color: #333;
      line-height: 1.5;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      padding: 20px 15px;
    }

    /* 상단 헤더 - 로고 + 회사명 */
    header {
      width: 100%;
      max-width: 900px;
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 30px;
    }
    header img {
      height: 50px;
      width: auto;
    }
    header h1 {
      font-size: 1.8rem;
      color: #d62828;
      margin: 0;
      user-select: none;
    }

    /* 네비게이션 (월 이동 버튼 + 현재 월) */
    .nav-buttons {
      width: 100%;
      max-width: 900px;
      text-align: center;
      margin-bottom: 15px;
      user-select: none;
    }
    .nav-buttons button {
      background-color: #d62828;
      border: none;
      color: white;
      font-weight: 700;
      padding: 10px 18px;
      margin: 0 8px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
      transition: background-color 0.3s ease;
    }
    .nav-buttons button:hover,
    .nav-buttons button:focus {
      background-color: #a32121;
      outline: none;
    }
    #currentMonth {
      font-weight: 700;
      font-size: 1.3rem;
      vertical-align: middle;
      user-select: text;
    }

    /* 달력 스타일 */
    table#calendar {
      width: 100%;
      max-width: 900px;
      border-collapse: collapse;
      box-shadow: 0 3px 8px rgba(0,0,0,0.12);
      border-radius: 10px;
      overflow: hidden;
      background-color: white;
      user-select: none;
    }
    #calendar th, #calendar td {
      border: 1px solid #ddd;
      text-align: center;
      vertical-align: top;
      padding: 10px 6px;
      height: 110px;
      position: relative;
      cursor: pointer;
      transition: background-color 0.25s ease;
      word-break: break-word;
    }
    #calendar th {
      background-color: #d62828;
      color: white;
      font-weight: 700;
      font-size: 1rem;
      user-select: none;
    }
    #calendar td:hover {
      background-color: #ffe5e0;
    }
    #calendar td.selected {
      border: 3px solid #d62828;
      background-color: #fff0f0;
    }
    /* 오늘 날짜 강조 */
    #calendar td.today {
      box-shadow: inset 0 0 10px 2px #d62828aa;
    }
    /* 날짜 숫자 */
    .date-number {
      font-weight: 700;
      font-size: 1.15rem;
      margin-bottom: 8px;
      user-select: text;
    }
    /* 메모 미리보기 */
    .memo-preview {
      font-size: 0.8rem;
      color: #555;
      line-height: 1.15em;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      margin-bottom: 4px;
      user-select: text;
    }
    /* 메모 점 표시 */
    .memo-dot {
      width: 9px;
      height: 9px;
      background: #d62828;
      border-radius: 50%;
      position: absolute;
      bottom: 6px;
      right: 6px;
    }

    /* 메모 영역 */
    #memoArea {
      width: 100%;
      max-width: 900px;
      background: white;
      margin-top: 25px;
      border-radius: 10px;
      padding: 25px 30px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
      user-select: text;
    }
    #memoArea h3 {
      margin-top: 0;
      color: #d62828;
      font-weight: 700;
      font-size: 1.4rem;
      margin-bottom: 18px;
    }
    #selectedDateDisplay {
      font-weight: 700;
      color: #d62828;
      font-size: 1.2rem;
      user-select: text;
    }
    #memoList {
      list-style: none;
      padding-left: 0;
      max-height: 220px;
      overflow-y: auto;
      margin-bottom: 20px;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
    #memoList li {
      padding: 10px 48px 10px 15px;
      border-bottom: 1px solid #eee;
      position: relative;
      word-break: break-word;
      font-size: 1rem;
    }
    #memoList li:last-child {
      border-bottom: none;
    }
    #memoList li button {
      position: absolute;
      top: 50%;
      right: 12px;
      transform: translateY(-50%);
      background-color: #d62828;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 5px 11px;
      font-weight: 700;
      cursor: pointer;
      transition: background-color 0.3s ease;
      user-select: none;
    }
    #memoList li button:hover,
    #memoList li button:focus {
      background-color: #a32121;
      outline: none;
    }

    /* 새 메모 입력창 */
    #newMemo {
      width: 100%;
      height: 90px;
      border-radius: 8px;
      padding: 12px 14px;
      resize: vertical;
      border: 1.5px solid #ccc;
      font-size: 1rem;
      transition: border-color 0.3s ease;
      font-family: 'Noto Sans KR', sans-serif;
    }
    #newMemo:focus {
      border-color: #d62828;
      outline: none;
    }
    #addMemoBtn {
      margin-top: 15px;
      float: right;
      background-color: #d62828;
      color: white;
      border: none;
      padding: 12px 26px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 700;
      font-size: 1.1rem;
      transition: background-color 0.3s ease;
      user-select: none;
    }
    #addMemoBtn:hover,
    #addMemoBtn:focus {
      background-color: #a32121;
      outline: none;
    }

    /* 푸터 */
    footer {
      margin-top: 40px;
      padding: 10px 0;
      width: 100%;
      max-width: 900px;
      text-align: center;
      font-size: 0.9rem;
      color: #666;
      user-select: none;
    }

    /* 반응형 */
    @media (max-width: 600px) {
      #calendar th, #calendar td {
        height: 80px;
        padding: 6px 4px;
        font-size: 0.85rem;
      }
      #memoArea {
        padding: 20px 15px;
      }
      #newMemo {
        height: 70px;
        font-size: 0.9rem;
      }
      #addMemoBtn {
        padding: 10px 20px;
        font-size: 1rem;
      }
      header h1 {
        font-size: 1.4rem;
      }
    }
  </style>
</head>
<body>

<header>
  <img src="두드림소방로고.PNG" alt="두드림소방 로고" />
  <h1>두드림소방 일정관리</h1>
</header>

<div class="nav-buttons" role="navigation" aria-label="월별 이동">
  <button type="button" onclick="prevMonth()" aria-label="이전 달 이동">◀ 이전달</button>
  <span id="currentMonth" aria-live="polite"></span>
  <button type="button" onclick="nextMonth()" aria-label="다음 달 이동">다음달 ▶</button>
</div>

<table id="calendar" role="grid" aria-label="달력">
  <!-- JS에서 채워짐 -->
</table>

<section id="memoArea" aria-live="polite">
  <h3>선택한 날짜 메모 <span id="selectedDateDisplay"></span></h3>
  <ul id="memoList" tabindex="0"><li>날짜를 선택하세요.</li></ul>
  <textarea id="newMemo" placeholder="새 메모를 입력하세요." aria-label="새 메모 입력"></textarea>
  <button id="addMemoBtn" onclick="addMemo()">메모 추가</button>
</section>

<footer>
  © 2025 두드림소방 | 전화: 0507-1394-5324 | 이메일: dodreamfire@naver.com
</footer>

<script>
  let currentYear, currentMonth;
  let selectedDate = null;
  let memos = {};

  function loadMemos() {
    const data = localStorage.getItem('calendarMemosMulti');
    memos = data ? JSON.parse(data) : {};
  }

  function saveMemos() {
    localStorage.setItem('calendarMemosMulti', JSON.stringify(memos));
  }

  function shortMemo(text, maxLen=15){
    if(text.length <= maxLen) return text;
    return text.slice(0, maxLen) + '...';
  }

  function buildCalendar(year, month) {
    currentYear = year;
    currentMonth = month;
    selectedDate = null;

    const currentMonthSpan = document.getElementById('currentMonth');
    currentMonthSpan.textContent = `${year}년 ${month + 1}월`;

    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    const today = new Date();

    const calendarEl = document.getElementById('calendar');

    let html = '<thead><tr><th scope="col">일</th><th scope="col">월</th><th scope="col">화</th><th scope="col">수</th><th scope="col">목</th><th scope="col">금</th><th scope="col">토</th></tr></thead><tbody><tr>';

    // 빈 칸 채우기
    for(let i=0; i < firstDay.getDay(); i++){
      html += '<td></td>';
    }

    for(let day=1; day <= lastDay.getDate(); day++){
      const dateKey = `${year}-${month + 1}-${day}`;
      const hasMemo = memos[dateKey] && memos[dateKey].length > 0;

      // 오늘 날짜인지 체크
      const isToday = (year === today.getFullYear() && month === today.getMonth() && day === today.getDate());

      html += `<td
        class="${hasMemo ? 'hasMemo' : ''} ${isToday ? 'today' : ''}"
        onclick="selectDate(${year},${month},${day}, this)"
        tabindex="0"
        role="gridcell"
        aria-label="${day}일${hasMemo ? ', 메모 있음' : ''}${isToday ? ', 오늘' : ''}"
        onkeydown="if(event.key==='Enter' || event.key===' ') selectDate(${year},${month},${day}, this)"
        style="position:relative;"
        >`;

      html += `<div class="date-number">${day}</div>`;

      if(hasMemo){
        const previewMemos = memos[dateKey].slice(0, 2);
        previewMemos.forEach(memo => {
          html += `<div class="memo-preview" title="${memo}">${shortMemo(memo)}</div>`;
        });
        html += `<div class="memo-dot" title="메모 있음"></div>`;
      }
      html += '</td>';

      if((firstDay.getDay() + day) % 7 === 0 && day !== lastDay.getDate()){
        html += '</tr><tr>';
      }
    }

    // 남은 칸 빈칸 채우기
    const remaining = (7 - (firstDay.getDay() + lastDay.getDate()) % 7) % 7;
    for(let i=0; i<remaining; i++){
      html += '<td></td>';
